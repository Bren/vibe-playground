const { google } = require('googleapis');

// Google Sheets configuration
const SHEET_ID = '1GgoGvCzW74vSqoaQeQmeGYEdNvLMY64iklDjCTYYOcY';
const SHEET_NAME = 'Published';

// Nickname database for celebrities
const nicknameDatabase = {
    // Israeli celebrities
    'עדן גולן': ['עדן', 'Eden Golan'],
    'מאיר סוויסה': ['מאיר', 'Meir Swisa'],
    'חני נחמיאס': ['חני', 'Hanny'],
    'דני אבדיה': ['דני', 'Deni Avdija'],
    'מאיה בוסקילה': ['מאיה', 'Maya Bouskilla'],
    'עופר כסיף': ['עופר', 'Ofer Cassif'],
    'יצחק עמית': ['יצחק', 'Yitzhak Amit'],
    'יזהר כהן': ['יזהר', 'Yizhar Cohen'],
    'אליניב ברדה': ['אליניב', 'Elyaniv Barda'],
    'יסמין מועלם': ['יסמין', 'Jasmin Moallem'],
    'יצחק שמיר': ['יצחק', 'Yitzhak Shamir'],
    'אריק איינשטיין': ['אריק', 'Arik Einstein'],
    'לימור סון הר מלך': ['לימור', 'Limor Son Har-Melech'],
    'מיה לנדסמן': ['מיה', 'Mia Landesman'],
    'פנינה רוזנבלום': ['פנינה', 'Pnina Rosenblum'],
    'אייל ברקוביץ\'': ['אייל', 'Eyal Berkovic'],
    'מתי כספי': ['מתי', 'Matti Caspi'],
    'שרי רז': ['שרי', 'Shari Raz'],
    'עדן בן זקן': ['עדן', 'Eden Ben Zaken'],
    'הרב עובדיה יוסף': ['הרב עובדיה', 'Rav Ovadia'],
    'אבי דיכטר': ['אבי', 'Avi Dichter'],
    'בר טימור': ['בר', 'Bar Timor'],
    'קורין אלאל': ['קורין', 'Korin Allal'],
    'משה ליאון': ['משה', 'Moshe Lion'],
    'אפרת רייטן': ['אפרת', 'Efrat Rayten'],
    'מוטי קירשנבאום': ['מוטי', 'Moti Kirschenbaum'],
    'רבקה מיכאלי': ['רבקה', 'Rivka Michaeli'],
    'יובל המבולבל': ['יובל', 'Yuval Shem Tov'],
    'עזאם עזאם': ['עזאם', 'Azzam Azzam'],
    'ז\'וז\'ו חלסטרה': ['ז\'וז\'ו', 'Zuzu'],
    'עדי קיסר': ['עדי', 'Adi Keissar'],
    'ינוון מגל': ['ינוון', 'Yinon Magal'],
    'קובי אוז': ['קובי', 'Kobi Oz'],
    'ציפי שביט': ['ציפי', 'Tsippi Shavit'],
    'בריז\'יט בארדו': ['בריז\'יט', 'Brigitte Bardot'],
    'ג\'סטין ביבר': ['ג\'סטין', 'Justin Bieber'],
    'אליזבת מוס': ['אליזבת', 'Elisabeth Moss'],
    'תומר קאפון': ['תומר', 'Tomer Kapon'],
    'פטריק סטיוארט': ['פטריק', 'Patrick Stewart'],
    'באז אולדרין': ['באז', 'Buzz Aldrin'],
    'ארקדי דוכין': ['ארקדי', 'Arkadi Duchin'],
    'סיימון קאוול': ['סיימון', 'Simon Cowell'],
    'מלניה טראמפ': ['מלניה', 'Melania Trump'],
    'יובל דיין': ['יובל', 'Yuval Dayan'],
    'מנחם בגין': ['מנחם', 'Menachem Begin'],
    'ארטיום דולגופיאט': ['ארטיום', 'Artem Dolgopyat'],
    'צ\'רלי צ\'פלין': ['צ\'רלי', 'Charlie Chaplin'],
    'מירי אלוני': ['מירי', 'Miri Aloni'],
    'אריק זאבי': ['אריק', 'Ariel Ze\'evi'],
    'ביל גייטס': ['ביל', 'Bill Gates'],
    'אלאניס מוריסט': ['אלאניס', 'Alanis Morissette'],
    'הילארי סוואנק': ['הילארי', 'Hilary Swank'],
    'גאולה אבן-סער': ['גאולה', 'Geula Even Saar'],
    'אנטוני בלינקן': ['אנטוני', 'Antony Blinken'],
    'גרייס קלי': ['גרייס', 'Grace Kelly'],
    'מייקל פלפס': ['מייקל', 'Michael Phelps'],
    'לינוי בר גפן': ['לינוי', 'Linoy Bar Geffen'],
    'לוונה צ\'מטאי-סלפטר': ['לוונה', 'Lonah Chemtai'],
    'סטף קרי': ['סטף', 'Steph Curry'],
    'גיא לרר': ['גיא', 'Guy Lerer'],
    'מרגלית צנעני': ['מרגלית', 'Margol'],
    'אודרי טוטו': ['אודרי', 'Audrey Tautou'],
    'ברוך קרא': ['ברוך', 'Baruch Kra'],
    'אסף אמדורסקי': ['אסף', 'Assaf Amdursky'],
    'יאיר שרקי': ['יאיר', 'Yair Sharki'],
    'ניקי מינאז\'': ['ניקי', 'Nicki Minaj'],
    'מרתה סטיוארט': ['מרתה', 'Martha Stewart'],
    'מרגרט תאצ\'ר': ['מרגרט', 'Margaret Thatcher'],
    'פול ניומן': ['פול', 'Paul Newman'],
    'דורית ביניש': ['דורית', 'Dorit Beinisch'],
    'ג\'ים מוריסון': ['ג\'ים', 'Jim Morrison'],
    'עידן עמדי': ['עידן', 'Idan Amadi'],
    'מליסה מקארתי': ['מליסה', 'Melissa McCarthy'],
    'יפה בן דוד': ['יפה', 'Yafa Ben David'],
    'ארנון בר דוד': ['ארנון', 'Arnon Bar David'],
    'ניקול קידמן': ['ניקול', 'Nicole Kidman'],
    'אפרים קישון': ['אפרים', 'Ephraim Kishon'],
    'דינה סנדרסון': ['דינה', 'Dina Sanderson'],
    'משה גפני': ['משה', 'Moshe Gafni'],
    'בוראט סאגדייב': ['בוראט', 'Borat Sagdiyev'],
    'ברני סנדרס': ['ברני', 'Bernie Sanders'],
    'טל ברמן': ['טל', 'Tal Berman'],
    'הילארי קלינטון': ['הילארי', 'Hillary Clinton'],
    'אוסמה בן-לאדן': ['אוסמה', 'Osama bin Laden'],
    'אהוד בנאי': ['אהוד', 'Ehud Banai'],
    'נב קמפבל': ['נב', 'Neve Campbell'],
    'כרמי ברזאטו': ['כרמי', 'Carmy Berzatto'],
    'דיאנה רוס': ['דיאנה', 'Diana Ross'],
    'וופי גולדברג': ['וופי', 'Whoopi Goldberg'],
    'ליא קניג': ['ליא', 'Lea Koenig'],
    'ראמזי עבד רמזי': ['ראמזי', 'Ramzi Abd Ramzi'],
    'פרינס': ['Prince', 'The Artist Formerly Known as Prince'],
    'יעל דיין': ['יעל', 'Yael Dayan'],
    'אסי דיין': ['אסי', 'Assi Dayan'],
    'רונאלדו': ['Ronaldo', 'CR7', 'Cristiano Ronaldo'],
    'ג\'יי. די ואנס': ['ג\'יי. די', 'J.D. Vance'],
    'ג\'ורג\' קוסטנזה / ג\'ייסון אלכסנדר': ['ג\'ורג\'', 'Jason Alexander'],
    'מיה דגן': ['מיה', 'Mia Dagan'],
    'חנוך דאום': ['חנוך', 'Hanoch Daum'],
    'עוגן סיטון / אורלי וינרמן': ['עוגן', 'Ogan Siton'],
    'עידו רוזנבלום': ['עידו', 'Ido Rosenblum'],
    'ליב טיילר': ['ליב', 'Liv Tyler'],
    'קייט בוש': ['קייט', 'Kate Bush'],
    'אסף אשתר': ['אסף', 'Asaf Ashtar'],
    'ליאל עבדה': ['ליאל', 'Liel Abada'],
    'ג\'ים קארי': ['ג\'ים', 'Jim Carrey'],
    'מיכל אמדורסקי': ['מיכל', 'Michal Amdursky'],
    'אביבית בר זוהר': ['אביבית', 'Avivit Bar Zohar'],
    'חיים ילין': ['חיים', 'Haim Yelin'],
    'לאורה ריבלין': ['לאורה', 'Leora Rivlin'],
    'לני קרביץ': ['לני', 'Lenny Kravitz'],
    'עברי לידר': ['עברי', 'Ivri Lider'],
    'וינס ווהן': ['וינס', 'Vince Vaughn'],
    'האלק הוגאן': ['האלק', 'Hulk Hogan'],
    'יעל פוליאקוב': ['יעל', 'Yael Poliakov'],
    'קניה ווסט': ['קניה', 'Kanye West'],
    'נרקיס': ['Narcissus', 'Narcissus'],
    'דני קושמרו': ['דני', 'Danny Kushmaro'],
    'אירנה': ['Irina', 'Irina'],
    'קלאודיה שיפר': ['קלאודיה', 'Claudia Schiffer'],
    'נעמי שמר': ['נעמי', 'Naomi Shemer'],
    'הארי סטיילס': ['הארי', 'Harry Styles'],
    'נולי': ['Noli', 'Noli'],
    'ג\'ון אוליבר': ['ג\'ון', 'John Oliver'],
    'מיה וואלאס': ['מיה', 'Mia Wallace'],
    'מאיר אריאל': ['מאיר', 'Meir Ariel'],
    'שחר פאר': ['שחר', 'Shahar Peer'],
    'ריפלי (סיגורני וויבר)': ['ריפלי', 'Ripley'],
    'הארי קיין': ['הארי', 'Harry Kane'],
    'נס': ['Ness', 'Ness'],
    'עזר ויצמן': ['עזר', 'Ezer Weizman'],
    'מל סי': ['מל', 'MC'],
    'ג\'ין סימונס': ['ג\'ין', 'Gene Simmons'],
    'אלמוג כהן': ['אלמוג', 'Almog Cohen'],
    'גרייס ג\'ונס': ['גרייס', 'Grace Jones'],
    'אייל קיציס': ['אייל', 'Eyal Kitzis'],
    'הדס קליין': ['הדס', 'Hadassah Klein'],
    'ג\'ימי קרטר': ['ג\'ימי', 'Jimmy Carter'],
    'ישראל אהרוני': ['ישראל', 'Yisrael Aharoni'],
    'קמלה האריס': ['קמלה', 'Kamala Harris'],
    'אלונה סער': ['אלונה', 'Alona Saar'],
    'ג\'ורדי קרויף': ['ג\'ורדי', 'Jordi Cruyff'],
    'מוריסי': ['Morrissey', 'Morrissey'],
    'ניר ברקת': ['ניר', 'Nir Barkat'],
    'מירב בן ארי': ['מירב', 'Mirav Ben Ari'],
    'רן בן שמעון': ['רן', 'Ran Ben Shimon'],
    'מגי אזרזר': ['מגי', 'Magi Azarzar'],
    'חירט וילדרס': ['חירט', 'Geert Wilders'],
    'צחי ברוורמן': ['צחי', 'Tzachi Braverman'],
    'עדן חסון': ['עדן', 'Eden Hason'],
    'רד אורבך': ['רד', 'Red Auerbach'],
    'מרתה (כדורגלנית)': ['מרתה', 'Marta'],
    'איוונקה טראמפ': ['איוונקה', 'Ivanka Trump'],
    'נדיה קומנצ\'י': ['נדיה', 'Nadia Comăneci'],
    'עדי זריפי': ['עדי', 'Adi Zarifi'],
    'יוני רכטר': ['יוני', 'Yoni Rechter'],
    'חיים כהן': ['חיים', 'Haim Cohen'],
    'ליאונרדו דיקפריו': ['ליאונרדו', 'Leonardo DiCaprio'],
    'ג\'ורג\'ה מלוני': ['ג\'ורג\'ה', 'Giorgia Meloni'],
    'ג\'יי. קיי רולינג': ['ג\'יי. קיי', 'J.K. Rowling'],
    'אסתי גינזבורג': ['אסתי', 'Esti Ginzborg'],
    'מארי קירי': ['מארי', 'Marie Curie'],
    'מרי פופינס': ['מרי', 'Mary Poppins'],
    'פרדי מרקורי': ['פרדי', 'Freddie Mercury'],
    'פרנץ קפקא': ['פרנץ', 'Franz Kafka'],
    'עומר אדם': ['עומר', 'Omer Adam'],
    'אנגלה מרקל': ['אנגלה', 'Angela Merkel'],
    'רינה מצליח': ['רינה', 'Rina Matzliach'],
    'יו גרנט': ['יו', 'Hugh Grant'],
    'עודד מנשה': ['עודד', 'Oded Menashe'],
    'בשאר אל-אסד': ['בשאר', 'Bashar al-Assad'],
    'גולן יוכפז': ['גולן', 'Golan Yochpaz'],
    'מיקי זוהר': ['מיקי', 'Miki Zohar'],
    'ניב סולטן': ['ניב', 'Niv Sultain'],
    'אלונה ברקת': ['אלונה', 'Alona Barkat'],
    'דנה ברגר': ['דנה', 'Dana Berger'],
    'ריקי גל': ['ריקי', 'Riki Gal'],
    'נדב ארגמן': ['נדב', 'Nadav Argaman'],
    'יהודה חן / יניב ביטון': ['יהודה', 'Yehuda Hen'],
    'אליזבת הרמון / אניה טיילור-ג\'וי': ['אליזבת', 'Elizabeth Harmon'],
    'עדנה בליליוס': ['עדנה', 'Edna Blilious'],
    'מיכאל שמש': ['מיכאל', 'Michael Shemesh'],
    'סילביה המשתוללת / ניצה שאול': ['סילביה', 'Silvia'],
    'סלוודור דאלי': ['סלוודור', 'Salvador Dalí'],
    'פיבי בופה / ליסה קודרו': ['פיבי', 'Phoebe Buffay'],
    'רז הרשקו': ['רז', 'Raz Hershko'],
    'דני לוי': ['דני', 'Danny Levi'],
    'ישו': ['Jesus', 'Christ', 'ישוע'],
    'הגרינץ\'': ['Grinch', 'The Grinch'],
    'לארי בירד': ['לארי', 'Larry Bird'],
    'דבי הארי': ['דבי', 'Debbie Harry'],
    'יגאל בשן': ['יגאל', 'Yigael Bashan'],
    'ג\'ונתן פולארד': ['ג\'ונתן', 'Jonathan Pollard'],
    'טוויטי': ['Tweety', 'Tweety Bird'],
    'אהובה עוזרי': ['אהובה', 'Ahuvah Ozery'],
    'פמלה אנדרסון': ['פמלה', 'Pamela Anderson'],
    'ג\'יימס בונד': ['ג\'יימס', 'James Bond', '007'],
    'טלי גוטליב': ['טלי', 'Tali Gottlieb'],
    'ביל אקמן': ['ביל', 'Bill Ackman'],
    'ליז צ\'ייני': ['ליז', 'Liz Cheney'],
    'אדריאן ברודי': ['אדריאן', 'Adrien Brody'],
    'דמי מור': ['דמי', 'Demi Moore'],
    'פבלו אסקובר': ['פבלו', 'Pablo Escobar'],
    'אהרן ברק': ['אהרן', 'Aharon Barak'],
    'גדעון סער': ['גדעון', 'Gideon Sa\'ar'],
    'דפנה ברק ארז': ['דפנה', 'Daphne Barak-Erez'],
    'ערד ניר': ['ערד', 'Arad Nir'],
    'אנני לנוקס': ['אנני', 'Annie Lennox'],
    'שולמית אלוני': ['שולמית', 'Shulamit Aloni'],
    'ונסה פראדי': ['ונסה', 'Vanessa Paradis'],
    'דייל קופר / קייל מקלכלן': ['דייל', 'Dale Cooper'],
    'סלאש': ['Slash', 'Slash'],
    'שירה האס': ['שירה', 'Shira Haas'],
    'זאב רווח': ['זאב', 'Ze\'ev Revach'],
    'אראל סג"ל': ['אראל', 'Erel Segal'],
    'ארסן ונגר': ['ארסן', 'Arsène Wenger'],
    'עדה יונת': ['עדה', 'Ada Yonath'],
    'מריה קארי': ['מריה', 'Mariah Carey'],
    'רוס גלר': ['רוס', 'Ross Geller'],
    'הצל': ['The Shadow', 'הצל'],
    'מרסל מרסו': ['מרסל', 'Marcel Marceau'],
    'יעל דורון': ['יעל', 'Yael Doron'],
    'אורית סטרוק': ['אורית', 'Orit Strook'],
    'מוקי (דני ניב)': ['מוקי', 'Mooki'],
    'השרוף (חיים צינוביץ\')': ['השרוף', 'HaSaruf'],
    'שירלי טמפל': ['שירלי', 'Shirley Temple'],
    'אייל זמיר': ['אייל', 'Eyal Zamir'],
    'המלכה אליזבת השנייה': ['המלכה', 'Queen Elizabeth II'],
    'סטיבן טיילור': ['סטיבן', 'Steven Tyler'],
    'באפי': ['Buffy', 'Buffy the Vampire Slayer'],
    'כריסטיאנו רונאלדו': ['כריסטיאנו', 'Cristiano Ronaldo', 'CR7'],
    'דנה ויס': ['דנה', 'Dana Weiss'],
    'לוקה דונצ\'יץ\'': ['לוקה', 'Luka Dončić'],
    'סקאזי': ['Skazi', 'Skazi'],
    'מג ריאן': ['מג', 'Meg Ryan'],
    'ג\'יילן ברטס': ['ג\'יילן', 'Jalen Brats'],
    'יעל דן': ['יעל', 'Yael Dan'],
    'רובי וויליאמס': ['רובי', 'Robbie Williams'],
    'ג\'ון טרבולטה': ['ג\'ון', 'John Travolta'],
    'שמעון מזרחי': ['שמעון', 'Shimon Mizrachi'],
    'מואנה': ['Moana', 'Moana'],
    'ג\'וי ריגר': ['ג\'וי', 'Joey Rieger'],
    'נסרין קדרי': ['נסרין', 'Nasrin Kadri'],
    'אנדי וורהול': ['אנדי', 'Andy Warhol'],
    'דובי גל': ['דובי', 'Dubi Gal'],
    'מיכל הקטנה': ['מיכל', 'Michal Haketana'],
    'יוסף חדאד': ['יוסף', 'Yosef Hadad'],
    'ניקול ראידמן': ['ניקול', 'Nicole Raidman'],
    'צ\'רלי ביטון': ['צ\'רלי', 'Charlie Biton'],
    'דודי אמסלם': ['דודי', 'Dudi Amsalem'],
    'ג\'וליה גארנר': ['ג\'וליה', 'Julia Garner'],
    'באטמן': ['Batman', 'The Dark Knight'],
    'אמנון טיטינסקי / דב נבון': ['אמנון', 'Amnon Titinsky'],
    'גל תורן': ['גל', 'Gal Toren'],
    'לו ריד': ['לו', 'Lou Reed'],
    'דניס לויד': ['דניס', 'Dennis Lloyd'],
    'ג\'רי סיינפלד': ['ג\'רי', 'Jerry Seinfeld'],
    'עדי הימלבלוי': ['עדי', 'Adi Himmelbleu'],
    'מייקי מדיסון': ['מייקי', 'Mikey Madison'],
    'עופר ינאי': ['עופר', 'Ofer Yanai'],
    'ניימאר': ['Neymar', 'Neymar Jr.'],
    'אור-לי ברלב': ['אור-לי', 'Or-Li Barlev'],
    'הלו קיטי': ['Hello Kitty', 'Kitty'],
    'סיה': ['Sia', 'Sia'],
    'צחי הלוי': ['צחי', 'Tzachi Halevy'],
    'ליבנת אורינובסקי': ['ליבנת', 'Livnat Orinovski'],
    'גבי (בית הבובות של גבי)': ['גבי', 'Gabby'],
    'צ\'ייס (מפרץ ההרפתקאות)': ['צ\'ייס', 'Chase'],
    'רוברט קנדי ג\'וניור': ['רוברט', 'Robert F. Kennedy Jr.'],
    'רותם סלע': ['רותם', 'Rotem Sela'],
    'ויניסיוס': ['Vinícius', 'Vinícius Jr.'],
    'ג\'יזס / ג\'ון טורטורו': ['ג\'יזס', 'Jesus'],
    'ליבי שטיסל': ['ליבי', 'Libby Shtisel'],
    'אסתי (כמעט שבת שלום)': ['אסתי', 'Esti'],
    'אסף רפפורט': ['אסף', 'Assaf Rappaport'],
    'בניטו מוסוליני': ['בניטו', 'Benito Mussolini'],
    'גברת פלפלת': ['גברת פלפלת', 'Mrs. Pepperpot'],
    'זובין מהטה': ['זובין', 'Zubin Mehta'],
    'הלי אר': ['הלי', 'Heli'],
    'ג\'ולס / סמואל ל. ג\'קסון': ['ג\'ולס', 'Jules'],
    'שלגיה / רייצ\'ל זגלר': ['שלגיה', 'Snow White'],
    'אריאנה גרנדה': ['אריאנה', 'Ariana Grande'],
    'סברינה קרפנטר': ['סברינה', 'Sabrina Carpenter'],
    'עדן פינס': ['עדן', 'Eden Fines'],
    'אלי שרביט': ['אלי', 'Eli Sharvit'],
    'חיים נחמן ביאליק': ['חיים נחמן', 'Haim Nahman Bialik'],
    'שושנה דמארי': ['שושנה', 'Shoshana Damari'],
    'פדרו פסקל': ['פדרו', 'Pedro Pascal'],
    'עינב בובליל': ['עינב', 'Einav Boblil'],
    'זאק בראף': ['זאק', 'Zach Braff'],
    'רונית אלקבץ': ['רונית', 'Ronit Elkabetz'],
    'טום ריפלי / אנדרו סקוט': ['טום', 'Tom Ripley'],
    'פארוק (יוסף שילוח)': ['פארוק', 'Farouk'],
    'משיח (אודי כגן)': ['משיח', 'Mashiach'],
    'פטריק (בובספוג)': ['פטריק', 'Patrick Star'],
    'שלי הכובשת': ['שלי', 'Shelly'],
    'יוג\'ין (חברים בחווה)': ['יוג\'ין', 'Eugene'],
    'ברני הדינוזאור': ['ברני', 'Barney'],
    'סוניק הקיפוד': ['סוניק', 'Sonic'],
    'אמאיה (כוח PJ)': ['אמאיה', 'Amaya'],
    'סם סנואו (חקירות חייתיות)': ['סם', 'Sam Snow'],
    'מיני מאוס': ['מיני', 'Minnie Mouse'],
    'סטיב (מיינקראפט)': ['סטיב', 'Steve'],
    'בוב מארלי': ['בוב', 'Bob Marley'],
    'סת\' רוגן': ['סת\'', 'Seth Rogen'],
    'שלמה בר': ['שלמה', 'Shlomo Bar'],
    'דפנה לוסטיג': ['דפנה', 'Dafna Lustig'],
    'דנה אינטרנשיונל': ['דנה', 'Dana International'],
    'ג\'יימי ורדי': ['ג\'יימי', 'Jamie Vardy'],
    'לינה דנהאם': ['לינה', 'Lena Dunham'],
    'ג\'ייסון מומואה': ['ג\'ייסון', 'Jason Momoa'],
    'ארנה סלוט': ['ארנה', 'Arne Slot'],
    'עוזי חיטמן': ['עוזי', 'Uzi Chitman'],
    'וויטני יוסטון': ['וויטני', 'Whitney Houston'],
    'שרוליק': ['שרוליק', 'Srulik'],
    'אבשלום קור': ['אבשלום', 'Avshalom Kor'],
    'נטעלי שם טוב': ['נטעלי', 'Netali Shem Tov'],
    'יודה': ['Yoda', 'Master Yoda'],
    'דודו טסה': ['דודו', 'Dudu Tasa'],
    'חנה לסלאו (קלרה)': ['חנה', 'Hana Laszlo'],
    'גאולה נוני': ['גאולה', 'Geula Nuni'],
    'דודו פארוק / אורי קומאי': ['דודו', 'Dudu Faruk'],
    'ליאון טרוצקי': ['ליאון', 'Leon Trotsky'],
    'נלסון מנדלה': ['נלסון', 'Nelson Mandela'],
    'אבי לוזון': ['אבי', 'Avi Luzon'],
    'שרן השכל': ['שרן', 'Sharren Haskel'],
    'אחינועם ניני': ['אחינועם', 'Achinoam Nini'],
    'אחמד טיבי': ['אחמד', 'Ahmad Tibi'],
    'יובל רפאל': ['יובל', 'Yuval Rafael'],
    'חנמאל דורפמן': ['חנמאל', 'Hannamal Dorfman'],
    'ווינונה ריידר': ['ווינונה', 'Winona Ryder'],
    'איתי הרמן (הצ\'ייסר)': ['איתי', 'Itai Herman'],
    'אלמוג בוקר': ['אלמוג', 'Almog Boker'],
    'האלי ברי': ['האלי', 'Halle Berry'],
    'אריק ובנץ': ['אריק', 'Arik Bents'],
    'ברוס ספרינגסטין': ['ברוס', 'Bruce Springsteen'],
    'ג\'יזל': ['Giselle', 'Giselle'],
    'ליאו ה-14': ['ליאו', 'Pope Leo XIV'],
    'מיטש גולדהאר': ['מיטש', 'Mitch Goldhar'],
    'תום יער': ['תום', 'Tom Yaar'],
    'תם אהרון': ['תם', 'Tom Aharon'],
    'אדל בספלוב': ['אדל', 'Adele Baspalov'],
    'דן תורן': ['דן', 'Dan Toren'],
    'קווין ספייסי': ['קווין', 'Kevin Spacey'],
    'ציפי חוטובלי': ['ציפי', 'Tzipi Hotovely'],
    'נדב יעקבי': ['נדב', 'Nadav Yacavi'],
    'סטנלי פישר': ['סטנלי', 'Stanley Fischer'],
    'פרידה עוזיאל': ['פרידה', 'Frida Oziel'],
    'באגס באני': ['באגס', 'Bugs Bunny'],
    'רונלד רייגן': ['רונלד', 'Ronald Reagan'],
    'ליהי טולדנו': ['ליהי', 'Lihi Toledano'],
    'אילן רמון': ['אילן', 'Ilan Ramon'],
    'קוקו גוף': ['קוקו', 'Coco Gauff'],
    'גדי איזנקוט': ['גדי', 'Gadi Eisenkot'],
    'דניאל הגרי': ['דניאל', 'Daniel Hagari'],
    'פפ גווארדיולה': ['פפ', 'Pep Guardiola'],
    'ג. יפית': ['ג\'יפית', 'G. Yafit'],
    'ג\'נט לי': ['ג\'נט', 'Janet Leigh'],
    'תומר בר': ['תומר', 'Tomer Bar'],
    'איתן תבריזי': ['איתן', 'Eitan Taibrizi'],
    'טל גלבוע': ['טל', 'Tal Gilboa'],
    'לירון ויצמן': ['לירון', 'Liron Weizman'],
    'מוש בן ארי': ['מוש', 'Mosh Ben-Ari'],
    'הדר מוכתר': ['הדר', 'Hadar Mokhtar'],
    'יונה אליאן': ['יונה', 'Yona Elian'],
    'לייזה מינלי': ['לייזה', 'Liza Minnelli'],
    'פרודו': ['Frodo', 'Frodo Baggins'],
    'עלי חמינאי': ['עלי', 'Ali Khamenei'],
    'יוסי בנאי': ['יוסי', 'Yossi Banai'],
    'פארה פוסט': ['פארה', 'Farrah Fawcett'],
    'רננה רז': ['רננה', 'Renana Raz'],
    'יולן כהן': ['יולן', 'Yolan Cohen'],
    'דיאן קיטון': ['דיאן', 'Diane Keaton'],
    'אמינם': ['Eminem', 'Slim Shady'],
    'נפתלי בנט': ['נפתלי', 'Naftali Bennett'],
    'ברונו מארס': ['ברונו', 'Bruno Mars'],
    'מירי פסקל (אילן פלד)': ['מירי', 'Miri Pascal'],
    'שאולי (אסי כהן)': ['שאולי', 'Shauli'],
    'ג\'קי קנדי': ['ג\'קי', 'Jackie Kennedy'],
    'סאבלימינל': ['סאבלימינל', 'Subliminal'],
    'ג\'ורג\' בוש הבן': ['ג\'ורג\'', 'George W. Bush'],
    'לורד': ['לורד', 'Lord'],
    'ירדן ג\'רבי': ['ירדן', 'Yarden Gerbi'],
    'ציון אמיר': ['ציון', 'Zion Amir'],
    'המלך בבר': ['בבר', 'King Babar'],
    'יאיר לפיד': ['יאיר', 'Yair Lapid'],
    'ג\'יין בירקין': ['ג\'יין', 'Jane Birkin'],
    'אביעד גליקמן': ['אביעד', 'Aviad Glickman'],
    'נטע ריסקין / גיטי וייס': ['נטע', 'Neta Riskin'],
    'ישראל זיו': ['ישראל', 'Yisrael Ziv'],
    'סטינג': ['Sting', 'Sting'],
    'שולי רנד': ['שולי', 'Shuli Rand'],
    'נועה קירל': ['נועה', 'Noa Kirel'],
    'כריס מרטין': ['כריס', 'Chris Martin'],
    'איימן עודה': ['איימן', 'Ayman Odeh'],
    'מיה פארו': ['מיה', 'Mia Farrow'],
    'ג\'ניס ג\'ופלין': ['ג\'ניס', 'Janis Joplin'],
    'יולי אדלשטיין': ['יולי', 'Yuli Edelstein'],
    'אוזי אוסבורן': ['אוזי', 'Ozzy Osbourne'],
    'דניאלה וייס': ['דניאלה', 'Daniela Weiss'],
    'עינת שרוף': ['עינת', 'Einat Sharof'],
    'ארז טל': ['ארז', 'Erez Tal'],
    'סנופקין': ['Snufkin', 'Snufkin'],
    'אדל': ['Adele', 'Adele'],
    'אדוארד נורטון': ['אדוארד', 'Edward Norton'],
    'שמעון פרנס': ['שמעון', 'Shimon Peres'],
    'שר': ['Cher', 'Cher'],
    'לוצ\'יאנו פבארוטי': ['לוצ\'יאנו', 'Luciano Pavarotti'],
    'עדינה בר שלום': ['עדינה', 'Adina Bar Shalom'],
    'טייגר וודס': ['טייגר', 'Tiger Woods'],
    'ששון גבאי': ['ששון', 'Sasson Gabai'],
    'אגם רודברג': ['אגם', 'Agam Rodberg'],
    'ציון ברוך': ['ציון', 'Zion Baruch'],
    'אלון אולארצ\'יק': ['אלון', 'Alon Ularzik'],
    'אודיה אזולאי': ['אודיה', 'Odia Azoulay'],
    'דליק ווליניץ': ['דליק', 'Delik Volinitz'],
    'אקי אבני': ['אקי', 'Aki Avni'],
    'אורי ששון': ['אורי', 'Uri Sasson'],
    'שלי שלקה סנדרוב': ['שלי', 'Shali Shelka Sanderov'],
    'מאיר פרוש': ['מאיר', 'Meir Porush'],
    'רות גביזון': ['רות', 'Ruth Gavison'],
    'סטיב קארל': ['סטיב', 'Steve Carell'],
    'מיכאל אלוני': ['מיכאל', 'Michael Aloni'],
    'קרן פלס': ['קרן', 'Keren Peles'],
    'בני גנץ': ['בני', 'Benny Gantz'],
    'ליאור רז': ['ליאור', 'Lior Raz'],
    'אלן פומפיאו / מרדית גריי': ['אלן', 'Ellen Pompeo'],
    'מועמר קדאפי': ['מועמר', 'Muammar Gaddafi'],
    'ריבר פיניקס': ['ריבר', 'River Phoenix'],
    'מיקי חיימוביץ\'': ['מיקי', 'Miki Haimovich'],
    'הנסיכה שרלוט': ['שרלוט', 'Princess Charlotte'],
    'ירון לונדון': ['ירון', 'Yaron London'],
    'ג\'וני דפ': ['ג\'וני', 'Johnny Depp'],
    'מרגרט קוואלי': ['מרגרט', 'Margaret Qualley'],
    'קרמבו / רמי הויברגר': ['קרמבו', 'Krembo'],
    'יורם ארבל': ['יורם', 'Yoram Arbel'],
    'לימור לבנת': ['לימור', 'Limor Livnat'],
    'רובין וויליאמס': ['רובין', 'Robin Williams'],
    'מיכל אנסקי': ['מיכל', 'Michal Ansky'],
    'ירמי קפלן': ['ירמי', 'Yarimi Kaplan'],
    'מהטמה גנדי': ['מהטמה', 'Mahatma Gandhi'],
    'מרים פרץ': ['מרים', 'Miriam Peretz'],
    'יואב קוטנר': ['יואב', 'Yoav Kutner'],
    'ז\'וזה מוריניו': ['ז\'וזה', 'José Mourinho'],
    'פינק': ['Pink', 'Pink'],
    'יאניק סינר': ['יאניק', 'Jannik Sinner'],
    'שמעון פרס': ['שמעון', 'Shimon Peres', 'פרס']
};

async function addNicknamesBatch() {
    try {
        console.log('🔍 Adding nicknames in batches to avoid rate limits...');
        
        // Load credentials
        const credentials = require('./google-sheets-credentials.json');
        
        // Fix private key format
        if (credentials.private_key) {
            credentials.private_key = credentials.private_key.replace(/\\n/g, '\n');
        }
        
        const auth = new google.auth.GoogleAuth({
            credentials: credentials,
            scopes: ['https://www.googleapis.com/auth/spreadsheets']
        });

        const sheets = google.sheets({ version: 'v4', auth });
        
        // First, get the current data
        const response = await sheets.spreadsheets.values.get({
            spreadsheetId: SHEET_ID,
            range: `${SHEET_NAME}!A:G`,
        });

        const rows = response.data.values || [];
        console.log(`📊 Found ${rows.length} rows in the sheet`);
        
        // Process in batches of 10 to avoid rate limits
        const batchSize = 10;
        let processedCount = 0;
        
        for (let i = 1; i < rows.length; i += batchSize) {
            const batch = rows.slice(i, i + batchSize);
            const batchUpdates = [];
            
            for (let j = 0; j < batch.length; j++) {
                const row = batch[j];
                const name = row[0] || '';
                const rowIndex = i + j + 1;
                
                if (name && nicknameDatabase[name]) {
                    const nicknames = nicknameDatabase[name];
                    const nicknameString = nicknames.join(', ');
                    
                    batchUpdates.push({
                        range: `${SHEET_NAME}!G${rowIndex}`,
                        values: [[nicknameString]]
                    });
                    
                    console.log(`✅ Prepared nicknames for ${name}: ${nicknameString}`);
                }
            }
            
            if (batchUpdates.length > 0) {
                // Update the batch
                await sheets.spreadsheets.values.batchUpdate({
                    spreadsheetId: SHEET_ID,
                    resource: {
                        valueInputOption: 'RAW',
                        data: batchUpdates
                    }
                });
                
                processedCount += batchUpdates.length;
                console.log(`📝 Updated batch ${Math.ceil(i / batchSize)}: ${batchUpdates.length} celebrities`);
                
                // Wait 2 seconds between batches to avoid rate limits
                await new Promise(resolve => setTimeout(resolve, 2000));
            }
        }
        
        console.log(`🎉 Successfully added nicknames for ${processedCount} celebrities!`);
        
    } catch (error) {
        console.error('❌ Error adding nicknames:', error);
    }
}

// Run the function
addNicknamesBatch();




